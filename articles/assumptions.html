<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rempsyc">
<title>Quickly test linear regression assumptions â€¢ rempsyc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quickly test linear regression assumptions">
<meta property="og:description" content="rempsyc">
<meta property="og:image" content="https://rempsyc.remi-theriault.com/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-274QZTFL23"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-274QZTFL23');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rempsyc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>âˆš STATISTICS</h6>
    <a class="dropdown-item" href="../articles/table.html">APA tables</a>
    <a class="dropdown-item" href="../articles/t-test.html">t tests</a>
    <a class="dropdown-item" href="../articles/contrasts.html">Planned contrasts</a>
    <a class="dropdown-item" href="../articles/moderation.html">Moderations</a>
    <a class="dropdown-item" href="../articles/randomize.html">Randomization</a>
    <h6 class="dropdown-header" data-toc-skip>ðŸ“Š VISUALIZATION</h6>
    <a class="dropdown-item" href="../articles/violin.html">Violin plots</a>
    <a class="dropdown-item" href="../articles/scatter.html">Scatter plots</a>
    <a class="dropdown-item" href="../articles/circles.html">Overlapping circles</a>
    <a class="dropdown-item" href="../articles/assumptions.html">Assumptions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../TODOS.html">To-dos</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/featured.html">Featured In</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://doi.org/10.21105/joss.05466">JOSS Paper</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://lavaanExtra.remi-theriault.com/" aria-label="lavaanExtra">lavaanExtra</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/rempsyc" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rempsyc/rempsyc/" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sponsors/rempsyc" aria-label="Donate">
    <span class="fa fa-coffee"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="assumptions_files/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="assumptions_files/tabwid-1.1.3/tabwid.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quickly test linear regression assumptions</h1>
                        <h4 data-toc-skip class="author">RÃ©mi
ThÃ©riault</h4>
            
            <h4 data-toc-skip class="date">December 25, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rempsyc/rempsyc/blob/HEAD/vignettes/assumptions.Rmd" class="external-link"><code>vignettes/assumptions.Rmd</code></a></small>
      <div class="d-none name"><code>assumptions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basic-idea">Basic idea<a class="anchor" aria-label="anchor" href="#basic-idea"></a>
</h2>
<p>I recently discovered a wonderful package for easily checking linear
regression assumptions via diagnostic plots: the
<code><a href="https://easystats.github.io/performance/reference/check_model.html" class="external-link">check_model()</a></code> function of the <code>performance</code>
package.</p>
<p>Letâ€™s make a quick demonstration of this package first.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span></span>
<span><span class="co"># Note: if you haven't installed the packages above,</span></span>
<span><span class="co"># you'll need to install them first by using:</span></span>
<span><span class="co"># install_if_not_installed(c("performance", "see"))</span></span>
<span></span>
<span><span class="co"># Create a regression model (using data available in R by default)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">*</span> <span class="va">cyl</span> <span class="op">+</span> <span class="va">gear</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check model assumptions</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html" class="external-link">check_model</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-3-1.png" width="90%"></p>
<p>Wonderful! And efficient. However, sometimes, for different reasons,
someone might want to check assumptions with an objective test. Testing
each assumption one by one is kind of time-consuming, so I made a
convenience function to accelerate this process.</p>
<p>Just a <strong>warning</strong> before jumping into objective
assumption tests. Note these tests are generally NOT recommended! With a
large sample size, objective assumption tests will be OVER-sensitive to
deviations from expected values, while with a small sample size, the
objective assumption tests will be UNDER-powered to detect real,
existing deviations. It can also mask other visual patterns not
reflected in a single number. It is thus recommended to use visual
assessment of diagnostic plots instead (e.g., see <a href="https://doi.org/10.3758/s13428-023-02072-x" class="external-link">Shatz, 2023</a>, Kozak
&amp; Piepho, 2018, <a href="https://doi.org/10.1111/jac.12220" class="external-link uri">https://doi.org/10.1111/jac.12220</a>; <a href="https://doi.org/10.1080/03610920600853308" class="external-link">Schucany &amp; Ng,
2006</a>). For a quick and accessible argument against tests of
normality specifically, see <u><a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90" class="external-link">this
source</a></u>.</p>
<div class="section level3">
<h3 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>Load the <code>rempsyc</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rempsyc.remi-theriault.com">rempsyc</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong><em>Note:</em></strong> If you havenâ€™t installed this package
yet, you will need to install it via the following command:
<code>install.packages("rempsyc")</code>. Furthermore, you may be asked
to install the following packages if you havenâ€™t installed them already
(you may decide to install them all now to avoid interrupting your
workflow if you wish to follow this tutorial from beginning to end):</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"flextable"</span>, <span class="st">"performance"</span>, <span class="st">"see"</span>, <span class="st">"lmtest"</span>, <span class="st">"ggplot2"</span>,</span>
<span>  <span class="st">"qqplotr"</span>, <span class="st">"ggrepel"</span>, <span class="st">"patchwork"</span>, <span class="st">"boot"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/install_if_not_installed.html">install_if_not_installed</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></span></code></pre></div>
<hr>
<p>The raw output doesnâ€™t look so nice in the console because the column
names are so long, but it does look good in the viewer or when exported
to a word processing software because the column names get wrapped. You
can try it in RStudio yourself with the following command:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="../reference/nice_assumptions.html">nice_assumptions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://rempsyc.remi-theriault.com/images/blog_assumptions/assumptions1.png"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_table.html">nice_table</a></span><span class="op">(</span><span class="fu"><a href="../reference/nice_assumptions.html">nice_assumptions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, col.format.p <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="tabwid">
<style>.cl-0ab88f38{table-layout:auto;}.cl-0ab322f0{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0ab5674a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-0ab56754{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-0ab5792e{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ab57938{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ab57942{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-0ab88f38">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-0ab5792e"><p class="cl-0ab5674a"><span class="cl-0ab322f0">Model</span></p></th>
<th class="cl-0ab5792e"><p class="cl-0ab5674a"><span class="cl-0ab322f0">Normality (Shapiro-Wilk)</span></p></th>
<th class="cl-0ab5792e"><p class="cl-0ab5674a"><span class="cl-0ab322f0">Homoscedasticity (Breusch-Pagan)</span></p></th>
<th class="cl-0ab5792e"><p class="cl-0ab5674a"><span class="cl-0ab322f0">Autocorrelation of residuals (Durbin-Watson)</span></p></th>
<th class="cl-0ab5792e"><p class="cl-0ab5674a"><span class="cl-0ab322f0">Diagnostic</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-0ab57938"><p class="cl-0ab56754"><span class="cl-0ab322f0">mpg ~ wt * cyl + gear</span></p></td>
<td class="cl-0ab57942"><p class="cl-0ab5674a"><span class="cl-0ab322f0">.615</span></p></td>
<td class="cl-0ab57942"><p class="cl-0ab5674a"><span class="cl-0ab322f0">.054</span></p></td>
<td class="cl-0ab57942"><p class="cl-0ab5674a"><span class="cl-0ab322f0">.525</span></p></td>
<td class="cl-0ab57942"><p class="cl-0ab5674a"><span class="cl-0ab322f0">0.00</span></p></td>
</tr></tbody>
</table>
</div>
<blockquote>
<p>Interpretation: (p) values &lt; .05 imply assumptions are not
respected. Diagnostic is how many assumptions are not respected for a
given model or variable.</p>
</blockquote>
<p>This function is particularly useful when testing several models
simultaneously as it makes for a nice table of results. Letâ€™s make a
short demonstration of this.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define our dependent variables</span></span>
<span><span class="va">DV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Make list of all formulas</span></span>
<span><span class="va">formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DV</span>, <span class="st">"~ mpg"</span><span class="op">)</span></span>
<span><span class="co"># Make list of all models</span></span>
<span><span class="va">models.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">formulas</span>, FUN <span class="op">=</span> <span class="va">lm</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co"># Make diagnostic table</span></span>
<span><span class="va">assumptions.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nice_assumptions.html">nice_assumptions</a></span><span class="op">(</span><span class="va">models.list</span><span class="op">)</span></span></code></pre></div>
<p>Use the Viewer for better results</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">assumptions.table</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://rempsyc.remi-theriault.com/images/blog_assumptions/assumptions2.png"></p>
<p>Or alternatively with the <a href="../articles/table.html">nice_table() function</a></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_table.html">nice_table</a></span><span class="op">(</span><span class="va">assumptions.table</span>, col.format.p <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="tabwid">
<style>.cl-0b01a060{table-layout:auto;}.cl-0afc688e{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0afe8e16{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-0afe8e20{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-0afe9eba{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0afe9ec4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0afe9ece{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0afe9ecf{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0afe9ed0{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-0b01a060">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-0afe9eba"><p class="cl-0afe8e16"><span class="cl-0afc688e">Model</span></p></th>
<th class="cl-0afe9eba"><p class="cl-0afe8e16"><span class="cl-0afc688e">Normality (Shapiro-Wilk)</span></p></th>
<th class="cl-0afe9eba"><p class="cl-0afe8e16"><span class="cl-0afc688e">Homoscedasticity (Breusch-Pagan)</span></p></th>
<th class="cl-0afe9eba"><p class="cl-0afe8e16"><span class="cl-0afc688e">Autocorrelation of residuals (Durbin-Watson)</span></p></th>
<th class="cl-0afe9eba"><p class="cl-0afe8e16"><span class="cl-0afc688e">Diagnostic</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">cyl ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.361</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.282</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.460</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">disp ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.506</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.831</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.077</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">hp ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.004**</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.351</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.198</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">1.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">drat ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.939</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.887</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.505</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">wt ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.020*</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.270</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.002**</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">2.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">qsec ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.427</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.944</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.011*</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">1.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">vs ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.142</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.568</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.238</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">0.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">am ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.074</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.650</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">&lt; .001***</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">1.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ec4"><p class="cl-0afe8e20"><span class="cl-0afc688e">gear ~ mpg</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.001**</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">.528</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">&lt; .001***</span></p></td>
<td class="cl-0afe9ece"><p class="cl-0afe8e16"><span class="cl-0afc688e">2.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-0afe9ecf"><p class="cl-0afe8e20"><span class="cl-0afc688e">carb ~ mpg</span></p></td>
<td class="cl-0afe9ed0"><p class="cl-0afe8e16"><span class="cl-0afc688e">.008**</span></p></td>
<td class="cl-0afe9ed0"><p class="cl-0afe8e16"><span class="cl-0afc688e">.362</span></p></td>
<td class="cl-0afe9ed0"><p class="cl-0afe8e16"><span class="cl-0afc688e">.003**</span></p></td>
<td class="cl-0afe9ed0"><p class="cl-0afe8e16"><span class="cl-0afc688e">2.00</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="categorical-predictors">Categorical Predictors<a class="anchor" aria-label="anchor" href="#categorical-predictors"></a>
</h2>
<p>If you have categorical predictors (e.g., groups), then it is
suggested that you check assumptions directly on the raw data rather
than on the residuals <a href="https://stats.stackexchange.com/a/502177/195567" class="external-link">(source)</a>.</p>
<p>In this case, one can make qqplots on the different groups to first
check the normality assumption.</p>
</div>
<div class="section level2">
<h2 id="qq-plots">QQ Plots<a class="anchor" aria-label="anchor" href="#qq-plots"></a>
</h2>
<div class="section level3">
<h3 id="make-the-basic-plot">Make the basic plot<a class="anchor" aria-label="anchor" href="#make-the-basic-plot"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_qq.html">nice_qq</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-11-1.png" width="70%"></p>
<p>Generally speaking, as long as the dots lie within the confidence
band, all is good and the data distribute normally.</p>
</div>
<div class="section level3">
<h3 id="further-customization">Further customization<a class="anchor" aria-label="anchor" href="#further-customization"></a>
</h3>
<p>Change (or reorder) colours, x-axis title or y-axis title, names of
groups, no grid lines, or add the <em>p</em>-value from the Shapiro-Wilk
(if you wish so).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_qq.html">nice_qq</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BA38"</span>, <span class="st">"#619CFF"</span>, <span class="st">"#F8766D"</span><span class="op">)</span>,</span>
<span>  groups.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(a) Setosa"</span>, <span class="st">"(b) Versicolor"</span>, <span class="st">"(c) Virginica"</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shapiro <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-12-1.png" width="70%"></p>
<p>A <em>p</em> &gt; .05 suggests that your data is normally distributed
(according to the Shapiro-Wilk test). Inversely, a <em>p</em> &lt; .05
suggests your data is not normally distributed. Keep in mind however
that there are several known problems with objective tests, so visual
assessment is recommended. Nonetheless, for beginners, it can sometimes
be useful (or rather, reassuring) to be able to pair the visual
assessment to the tests values.</p>
</div>
</div>
<div class="section level2">
<h2 id="density-plots">Density Plots<a class="anchor" aria-label="anchor" href="#density-plots"></a>
</h2>
<p>Some people think that density distributions are less useful than
qqplots, but sometimes, people still like to look at distributions, so I
made another function for this.</p>
<div class="section level3">
<h3 id="make-the-basic-plot-1">Make the basic plot<a class="anchor" aria-label="anchor" href="#make-the-basic-plot-1"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_density.html">nice_density</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-13-1.png" width="70%"></p>
<p><strong>Pro tip</strong>: Save density plots with a narrower width
for better-looking results.</p>
</div>
<div class="section level3">
<h3 id="further-customization-1">Further customization<a class="anchor" aria-label="anchor" href="#further-customization-1"></a>
</h3>
<p>Change (or reorder) colours, x-axis title or y-axis title, names of
groups, no grid lines, or add the <em>p</em>-value from the Shapiro-Wilk
(if you wish so).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_density.html">nice_density</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BA38"</span>, <span class="st">"#619CFF"</span>, <span class="st">"#F8766D"</span><span class="op">)</span>,</span>
<span>  xtitle <span class="op">=</span> <span class="st">"Sepal Length"</span>,</span>
<span>  ytitle <span class="op">=</span> <span class="st">"Density (vs. Normal Distribution)"</span>,</span>
<span>  groups.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(a) Setosa"</span>, <span class="st">"(b) Versicolor"</span>, <span class="st">"(c) Virginica"</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shapiro <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  histogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Density (Sepal Length)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-14-1.png" width="70%"></p>
</div>
</div>
<div class="section level2">
<h2 id="density-qq-plots">Density + QQ Plots<a class="anchor" aria-label="anchor" href="#density-qq-plots"></a>
</h2>
<p>Finally, it is also possible to combine both these plot types with a
single function, <code>nice_normality</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_normality.html">nice_normality</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  shapiro <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  histogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Density (Sepal Length)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="outliers">Outliers<a class="anchor" aria-label="anchor" href="#outliers"></a>
</h2>
<p>To check outliers for categorical predictors, we can check for each
group whether any observations is greater than 3 units. By default it
uses median absolute deviations (MADs, with
<code>method = "mad"</code>), based on the following publication:</p>
<p>Leys, C., Klein, O., Bernard, P., &amp; Licata, L. (2013). Detecting
outliers: Do not use standard deviation around the mean, use absolute
deviation around the median. <em>Journal of Experimental Social
Psychology</em>, <em>49</em>(4), 764â€“766. <a href="https://doi.org/10.1016/j.jesp.2013.03.013" class="external-link">https://doi.org/10.1016/j.jesp.2013.03.013</a></p>
<div class="section level3">
<h3 id="make-the-basic-plot-2">Make the basic plot<a class="anchor" aria-label="anchor" href="#make-the-basic-plot-2"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_outliers.html">plot_outliers</a></span><span class="op">(</span></span>
<span>  <span class="va">airquality</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"Ozone"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-16-1.png" width="70%"></p>
<p>Be aware that checking outliers by group and not by group will yield
different results, e.g.,:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_outliers.html">plot_outliers</a></span><span class="op">(</span></span>
<span>  <span class="va">airquality</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"Ozone"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-17-1.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="further-customization-2">Further customization<a class="anchor" aria-label="anchor" href="#further-customization-2"></a>
</h3>
<p>Change (or reorder) colours, y-axis title, names of groups, or
detection method.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_outliers.html">plot_outliers</a></span><span class="op">(</span></span>
<span>  <span class="va">airquality</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"sd"</span>,</span>
<span>  criteria <span class="op">=</span> <span class="fl">3.29</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"pink"</span><span class="op">)</span>,</span>
<span>  ytitle <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>  xtitle <span class="op">=</span> <span class="st">"Month of the Year"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-18-1.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="flagging-outliers">Flagging outliers<a class="anchor" aria-label="anchor" href="#flagging-outliers"></a>
</h3>
<p>Outliers can also be identifed with <code>find_mad</code> and
multiple variables:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_mad.html">find_mad</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>, criteria <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 8 outlier(s) based on 3 median absolute deviations for variable(s): </span></span>
<span><span class="co">##  Ozone, Solar.R, Wind, Temp, Month, Day </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Outliers per variable: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ozone</span></span>
<span><span class="co">##   Row Ozone_mad</span></span>
<span><span class="co">## 1  30  3.218284</span></span>
<span><span class="co">## 2  62  3.989131</span></span>
<span><span class="co">## 3  99  3.488081</span></span>
<span><span class="co">## 4 101  3.025573</span></span>
<span><span class="co">## 5 117  5.261028</span></span>
<span><span class="co">## 6 121  3.333911</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Wind</span></span>
<span><span class="co">##   Row Wind_mad</span></span>
<span><span class="co">## 1   9 3.049871</span></span>
<span><span class="co">## 2  48 3.225825</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="winsorizing-outliers">Winsorizing outliers<a class="anchor" aria-label="anchor" href="#winsorizing-outliers"></a>
</h3>
<p>Outliers can also be winsorized with <code>winsorize_mad</code>,
meaning that outlier values outside 3 MADs will be brought back to 3
MADs:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/winsorize_mad.html">winsorize_mad</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Ozone</span>, criteria <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  41.0000  36.0000  12.0000  18.0000       NA  28.0000  23.0000  19.0000</span></span>
<span><span class="co">##  [9]   8.0000       NA   7.0000  16.0000  11.0000  14.0000  18.0000  14.0000</span></span>
<span><span class="co">## [17]  34.0000   6.0000  30.0000  11.0000   1.0000  11.0000   4.0000  32.0000</span></span>
<span><span class="co">## [25]       NA       NA       NA  23.0000  45.0000 109.3365</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multivariate-outliers">Multivariate outliers<a class="anchor" aria-label="anchor" href="#multivariate-outliers"></a>
</h3>
<p>For multivariate outliers, it is recommended to use the Minimum
Covariance Determinant (MCD), as available in the
<code>performance</code> package from <code>easystats</code> mentioned
in the beginning of this post.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_outliers.html" class="external-link">check_outliers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"mcd"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 7 outliers detected: cases 6, 7, 11, 14, 23, 34, 77.</span></span>
<span><span class="co">## - Based on the following method and threshold: mcd (22.458).</span></span>
<span><span class="co">## - For variables: Ozone, Solar.R, Wind, Temp, Month, Day.</span></span></code></pre>
<p>We note also that ideally the handling of outliers should be
preregistered a priori. For more up-to-date recommendations on handling
outliers, please see:</p>
<p>Leys, C., Delacre, M., Mora, Y. L., Lakens, D., &amp; Ley, C. (2019).
How to classify, detect, and manage univariate and multivariate
outliers, with emphasis on pre-registration. <em>International Review of
Social Psychology</em>, <em>32</em>(1). <a href="https://doi.org/10.5334/irsp.289" class="external-link">https://doi.org/10.5334/irsp.289</a></p>
</div>
</div>
<div class="section level2">
<h2 id="homoscedasticity-equality-of-variance">Homoscedasticity (equality of variance)<a class="anchor" aria-label="anchor" href="#homoscedasticity-equality-of-variance"></a>
</h2>
<p>To check homoscedasticity (equality of variance) for categorical
predictors, we can check the variance within each group. We can use a
rule of thumb that the variance of one group should not be four times
that of another group. We can check that with this function which makes
a table.</p>
<div class="section level3">
<h3 id="make-the-basic-table">Make the basic table<a class="anchor" aria-label="anchor" href="#make-the-basic-table"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="../reference/nice_var.html">nice_var</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://rempsyc.remi-theriault.com/images/blog_assumptions/var1.png"></p>
<p>Letâ€™s now try it for many variables to see how handy it can be.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define our dependent variables</span></span>
<span><span class="va">DV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make diagnostic table</span></span>
<span><span class="va">var.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nice_var.html">nice_var</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="va">DV</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Use the Viewer for better results (or export it to Word using my <a href="../articles/table.html">nice_table() function</a>)</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">var.table</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://rempsyc.remi-theriault.com/images/blog_assumptions/var2.png"></p>
</div>
<div class="section level3">
<h3 id="visualizing-variance">Visualizing Variance<a class="anchor" aria-label="anchor" href="#visualizing-variance"></a>
</h3>
<p>It can also be interesting to look at variance visually for learning
purposes.</p>
</div>
<div class="section level3">
<h3 id="make-the-basic-plot-3">Make the basic plot<a class="anchor" aria-label="anchor" href="#make-the-basic-plot-3"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_varplot.html">nice_varplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-25-1.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="further-customization-3">Further customization<a class="anchor" aria-label="anchor" href="#further-customization-3"></a>
</h3>
<p>Change (or reorder) colours, y-axis title, or names of groups.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nice_varplot.html">nice_varplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00BA38"</span>, <span class="st">"#619CFF"</span>, <span class="st">"#F8766D"</span><span class="op">)</span>,</span>
<span>  ytitle <span class="op">=</span> <span class="st">"Sepal Length"</span>,</span>
<span>  groups.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(a) Setosa"</span>, <span class="st">"(b) Versicolor"</span>, <span class="st">"(c) Virginica"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assumptions_files/figure-html/unnamed-chunk-26-1.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="thanks-for-checking-in">Thanks for checking in<a class="anchor" aria-label="anchor" href="#thanks-for-checking-in"></a>
</h3>
<p>Make sure to check out this page again if you use the code after a
time or if you encounter errors, as I periodically update or improve the
code. Feel free to contact me for comments, questions, or requests to
improve this function at <a href="https://github.com/rempsyc/rempsyc/issues" class="external-link">https://github.com/rempsyc/rempsyc/issues</a>.
See all tutorials here: <a href="https://remi-theriault.com/tutorials" class="external-link">https://remi-theriault.com/tutorials</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://remi-theriault.com" class="external-link">RÃ©mi ThÃ©riault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
